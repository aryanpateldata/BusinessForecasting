---
title: 'Hw1 : Business Forecasting Aryan Patel'
author: "Aryan Patel"
date: "2025-09-20"
output:
  html_document:
    df_print: paged
---
```{r, echo = FALSE, include=FALSE}
# importing libraries / reading in data 
library(readxl)
library(dplyr)

path = '/Users/aryanpatel/Downloads/Copy of Typical_Employee_Survey_Data.xlsx'


df <- path |> read_xlsx()

# convert to df 


df <- df |> as.data.frame()

```

*Dataset Preview *
```{r}
head(df,10)
```


**Question #1 Part 1 **
*1. Print out the 5-point summary and boxplot (numerical columns) for each column (20 points)*

```{r}
summary = df |> reframe(across(where(is.numeric), fivenum))

print(summary)
```
**Question #1 Part 2 **

```{r}
numeric_cols <- df |> sapply(is.numeric)
boxplot(df[, numeric_cols], main = " Box Plot of Numeric columns", ylab = "Value",cex.axis = 0.5,las = 2)
```




**Question #2**
*2. Convert the columns that need to be converted to Factors (20 points)*

```{r, echo = FALSE, include=FALSE}
# checking dataframe before converting to factor
head(df,10)
```

```{r, echo = FALSE, include=FALSE}
# checking class before converting to factor 
df |>
lapply(class)
```


```{r}
# 11 variables in total ,  Only years in job appears to be continuous and numeric . The rest of the columns all appear to be numeric discrete . The columns that are numeric discrete and ordinal I will convert into ordered factors . The columns that are numeric discrete but do not provide ordinal information I will keep as unordered factors. And since year in job is continuous and numeric I will not convert to factor . Age will also not be converted to ordered factor as it is mostly thought of as continuous and does not have few unique values 

# 1 -  Age is discrete numeric in our data set, but mostly is thought of as continuous and so I will not make into factor or ordered factor , and it does not have only a few unique values so I will keep as is 


# 2 - Gender is discrete numeric but not ordinal it can be 1 or 2 representing distinct groups (1 = Male , 2 = Female) so I will convert to un ordered factor and add the corresponding labels 
df$Gender = df$Gender |> factor(levels = c(1, 2),labels = c("Male", "Female"))


# 3 - Job Satisfaction is (4 distinct groups 1 = Very Satisfied , 2 = Moderately Satisfied , 3 = A Little Dissatisfied , 4 = Very Dissatisfied) although it is ordinal and discrete numeric,  it is not continuous, and has only a few distinct value ,  so this can be made into an ordered factor  

df$JobSatisfaction <- df$JobSatisfaction |> factor(levels = 1:4,labels = c("Very Satisfied", "Moderately Satisfied","A Little Dissatisfied ","Very Dissatisfied"),ordered = TRUE)



# 4 - ImpJobCharacteristic - Is 5 distinct groups, discrete numeric , not ordinal , representing which is most important to the employee (1 = High Incomes , 2 = No danger of being fired , 3 = Flexible hours , 4 = Opportunities for Advacement , 5 = Enjoying the work) . So I will make this into unordered factor

df$ImpJobCharacteristic <- df$ImpJobCharacteristic |> factor(levels = 1:5,labels = c("High Income","No Danger of Being Fired","Flexible Hours","Opportunities for Advancement","Enjoying the Work"))



#5 - YearsinJob - Is continuous and numeric , so i will not convert to factor or ordered factor and leave as is . 



# 6 PromotionLikelihood - Is 5 distinct groups , it is discrete numeric and ordinal . I will convert to ordered factor . (1 = Very Likely , 2 = Likely , 3 = Not Sure , 4 = Unlikely , 5 = Very Unlikely)

df$PromotionLikelihood <- df$PromotionLikelihood |> factor(ordered=TRUE,levels = 1:5,labels = c("Very Likely","Likely","Not Sure","Unlikely","Very Unlikely"))


#7 Decision Authority - 4 distinct groups , discrete numeric and ordinal . I will convert to ordered factor . (1 = Always , 2 = Much of the time , 3 = Sometimes , 4 = Never)


df$DecisionAuthority <- df$DecisionAuthority |> factor(ordered=TRUE,levels = 1:4,labels = c("Always","Much of the Time","Sometimes","Never"))


# 8 BudgetDecisionAuthority - discrete numeric , not ordinal . I will convert to unordered factor (1 =Yes  , 2 = No)

df$BudgetDecisionAuthority<- df$BudgetDecisionAuthority |> factor(levels = 1:2,labels = c("Yes","No"))



# 9 Proudness - Discrete numeric , ordinal . I will convert to ordered factor (1 = Very Proud , 2 = Somewhat Proud , 3 = Indifferent , 4 = Not At All Proud)

df$Proudness <- df$Proudness |> factor(levels = 1:4,labels = c("Very Proud","Somewhat Proud","Indifferent","Not At All Proud"),ordered=TRUE)



# 10 - JobChurn - Discrete numeric ordinal . I will convert to ordered factor (1 = Very Likely , 2 = Likely , 3 = Not sure , 4 = Unlikely , 5 = Very Unlikely)

df$JobChurn <- df$JobChurn |> factor(levels = 1:5,labels = c("Very Likely","Likely","Not Sure", "Unlikely","Very Unlikely"),ordered=TRUE)


# 11 - WorkRelationScore - Discrete numeric ordinal . I will convert to ordered factor (1 = Very good , 2 = Good , 3 = So So , 4 = Bad , 5 = Very Bad )


df$WorkRelationScore<- df$WorkRelationScore |> factor(levels = 1:5,labels = c("Very Good","Good","So So","Bad","Very Bad"),ordered=TRUE)

```




```{r}
# viewing dataframe after converting to factors 
head(df)
```

```{r}
# checking classes after converting to factors 
df |>
lapply(class)
```


**Question #3**
*3. Plot the right visual for each column (20 points)*
```{r echo = FALSE, include=FALSE}
library(ggplot2)
library(forcats)
```



```{r}
# Histogram plot of Age Columne # 1 , chose bindwidth = 5 for smoother bins 

df|>

ggplot(aes(x = Age)) + geom_histogram(binwidth = 5, fill = "green", color = "black") + labs(title = "Age Histogram", x = "Age", y = "Count") + scale_x_continuous(breaks = seq(0, 70, by = 5)) + theme_dark() 

```



```{r}
#2 Gender Pie chart Column # 2 

df |>

ggplot(aes(x = "",fill = Gender)) + geom_bar(width = 1) + coord_polar(theta = "y") + labs(title ="Gender Pie Chart",subtitle = "Male vs Female") + theme_linedraw() + geom_text(aes(label = after_stat(count)),stat = "count",position = position_stack(vjust = 0.5))


```







```{r}
# Histogram of Job satisfaction Column #3
df |>

ggplot(aes(x = JobSatisfaction)) + geom_bar(fill = "green", color = "black") + geom_text(stat = "count", aes(label = after_stat(count), y = after_stat(count)), vjust = -0.3) + labs(title = "Job Satisfaction Distribution", x = "Satisfaction Level", y = "Count") + theme_dark()




```


```{r}
# Histogram of ImpJobCharacteristic Column # 5 
df |>

ggplot(aes(x = fct_infreq(ImpJobCharacteristic))) + geom_bar(fill = "green", color = "black") + geom_text(stat = "count", aes(label = after_stat(count), y = after_stat(count)), vjust = -0.3) + labs(title = "Important Job Characteristic Histogram", x = "Characteristic", y = "Count") + theme_dark() + theme(axis.text.x = element_text(size = 6))



```



```{r}
# histogram of years in job -  Column # 5 
df |>

ggplot(aes(x = YearsinJob)) + geom_histogram(binwidth = 5, fill = "green", color = "black") +labs(title = "Years in Job", x = "Years", y = "Count") + scale_x_continuous(breaks = seq(0, 70, by = 5)) + theme_dark()
```


```{r}
# Histogram of PromotionLikelihood # Column 6

df |>

ggplot(aes(x = (PromotionLikelihood))) + geom_bar(fill = "green", color = "black") + geom_text(stat = "count", aes(label = after_stat(count), y = after_stat(count)), vjust = -0.3) + labs(title = "Promotion Likelihood", x = "Likelihood", y = "Count") + theme_dark()

```



```{r}
# Decision Authority Histogram column 7 

df |>

ggplot(aes(x = DecisionAuthority)) + geom_bar(fill = "green", color = "black") + geom_text(stat = "count", aes(label = after_stat(count), y = after_stat(count)), vjust = -0.3) + labs(title = "Decision Authority", x = "Authority Level", y = "Count") + theme_dark()

```


```{r}
# Budget Decision Authority Column 8


df |>

ggplot(aes(x = "",fill = BudgetDecisionAuthority)) + geom_bar(width = 1) + coord_polar(theta = "y") + labs(title ="Budget Decision Authority Pie Chart",subtitle = "Yes vs No") + theme_linedraw() + geom_text(aes(label = after_stat(count)),stat = "count",position = position_stack(vjust = 0.5))

```



```{r}
# Proudness Histogram - Column 9 


df |>

ggplot(aes(x = Proudness)) + geom_bar(fill = "green", color = "black") + geom_text(stat = "count", aes(label = after_stat(count), y = after_stat(count)), vjust = -0.3) + labs(title = "Proudness", x = "Level", y = "Count") + theme_dark()




```


```{r}
# Job Churn - Histogram - Column # 10 

df |>

ggplot(aes(x = JobChurn)) + geom_bar(fill = "green", color = "black") + geom_text(stat = "count", aes(label = after_stat(count), y = after_stat(count)), vjust = -0.3) + labs(title = "Job Churn", x = "Level", y = "Count") + theme_dark()



```



```{r}
# Work relation Score - Histogram - Column 11 - Last individual plot 

df |>

ggplot(aes(x = WorkRelationScore)) + geom_bar(fill = "green", color = "black") + geom_text(stat = "count", aes(label = after_stat(count), y = after_stat(count)), vjust = -0.3) + labs(title = "Work Relation Score", x = "Level", y = "Count") + theme_dark()



```

**Question #4**
*4. Plot scatter plots to show few relationships (20 points)*

```{r}

# Scatter plot between Age and Years in Job . 

df |>

ggplot(aes(x = Age, y = YearsinJob)) + geom_point() + labs(title = "Age vs Salary",x = "Age",y = "Years in Job") +  geom_smooth(method = "lm", se = TRUE, color = "red") + theme_dark()

```
*We can see positive linear relationship between both variables through the scatter plot and the geom_smooth line . Lets check correlation between both : *


```{r}
correlation <- cor(df$Age, df$YearsinJob)

print(correlation)
```

```{r}

# Scatter plot between promotion likelihood and proudness as both are numeric discrete I will use Bubble Plot for the scatter plot as other wise it would just show as a grid . Much of the time decision authority with promotion likely , Sometimes Decision Authority and Unlikely Promotion Authority , and Sometimes Decision Authority and Promotion Likelihood are the most common combinations from the bubble scatter plot. 

df |>
dplyr::count(PromotionLikelihood, DecisionAuthority) |>
ggplot(aes(x = PromotionLikelihood, y = DecisionAuthority, size  = n)) + geom_point(alpha = 0.9, color = "red") + labs(title = "Bubble Scatter Plot: Promotion Likelihood vs Decision Authority")

```
```{r}

correlation <- cor(as.numeric(df$DecisionAuthority), as.numeric(df$PromotionLikelihood))

print(correlation)

```

**Correlation is not as strong compared to Age and years and job .**





```{r}

# Scatter plot between Age and Years in Job . Since Work Relation Score is numeric discrete , values on y axis will always fall directly on a line .

df |>

ggplot(aes(x = Age, y = (ImpJobCharacteristic))) + geom_point() + labs(title = "Age vs Imp Job Characteristic",x = "Age",y = "Important Job Characteristic") +  theme_dark()

```
**From the scatter plot of age vs important job characteristic we can see that flexible hours only matters to people between 30-45. The rest of the reasons have a larger range , enjoying the work is the most popular reason and includes the most ages.**






